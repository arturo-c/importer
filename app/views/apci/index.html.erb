<h1>AllPlayers.com Server Login</h1>
<% unless @message.nil? %>
<div><em><%= @message %></em></div>
<% end %>
<% unless @status.nil? %>
<div><%= @status %></div>
<% end %>
<% unless session[:apci_session_start].nil? %>
<div>Started <%= distance_of_time_in_words(session[:apci_session_start], Time.now).to_s %> ago</div>
<% end %>

<% if session[:apci_session].nil? -%>
  <% form_remote_tag(:update => 'doc_preview', :url => {:controller => 'apci', :action => 'login'}) do %>
    <%= label_tag(:env, "Environment:") %>
    <%= select_tag :env, options_for_select(["www.a.acontreras.allplayers.com", "www.import.dev.allplayers.com", "www.allplayers.com", "www.pdup.allplayers.com"]),
      {:multiple => false, :onchange => 'document.getElementById("environment").value = document.getElementById("env").value;'} %>
    <%= label_tag(:user, "User:") %>
    <%= text_field_tag(:user) %>
    <%= label_tag(:pass, "Password:") %>
    <%= password_field_tag(:pass) %>
    <%= submit_tag 'Login' %>
  <% end %>
  <% form_remote_tag(:url => {:controller => 'apci', :action => 'login_oauth'}) do %>
    <%= hidden_field_tag :environment, 'www.import.dev.allplayers.com' %>
    <%= submit_tag 'Login with oauth' %>
  <% end %>
<% else -%>
  <% form_remote_tag(:update => 'doc_preview', :url => {:action=> 'logout', :controller => 'apci'}) do -%>
    <%= submit_tag 'Logout' %>
  <% end -%>
<% end -%>